---
# vars file for azure_pipelines_agent-ctl
azure_pipelines_agent_ctl_http_proxy_env: >-
  {% if azure_pipelines_agent_ctl_proxy['url'] is defined %}
  VSTS_HTTP_PROXY={{ azure_pipelines_agent_ctl_proxy['url'] }}
  {% endif %}
azure_pipelines_agent_ctl_proxy_username_env: >-
  {% if azure_pipelines_agent_ctl_proxy['username'] is defined %}
  VSTS_HTTP_PROXY_USERNAME={{ azure_pipelines_agent_ctl_proxy['username'] }}
  {% endif %}
azure_pipelines_agent_ctl_proxy_password_env: >-
  {% if azure_pipelines_agent_ctl_proxy['password'] is defined %}
  VSTS_HTTP_PROXY_PASSWORD={{ azure_pipelines_agent_ctl_proxy['password'] }}
  {% endif %}
azure_pipelines_agent_ctl_command_env_vector: "{{ [azure_pipelines_agent_ctl_http_proxy_env, azure_pipelines_agent_ctl_proxy_username_env, azure_pipelines_agent_ctl_proxy_password_env] | select('defined') }}"
azure_pipelines_agent_ctl_auth_flags: "--auth {{ azure_pipelines_agent_ctl_auth_mode }} {% if 'pat' == azure_pipelines_agent_ctl_auth_mode %}--token {{ azure_pipelines_agent_ctl_auth_token }}{% else %}--userName {{ azure_pipelines_agent_ctl_auth_username }} --password {{ azure_pipelines_agent_ctl_auth_password }}{% endif %}"
azure_pipelines_agent_ctl_base_config_cmd: '{{ azure_pipelines_agent_ctl_configuration_script }} --unattended --url {{ azure_pipelines_agent_ctl_devops_url }}'
azure_pipelines_agent_ctl_register_agent_cmd: '{{ azure_pipelines_agent_ctl_base_config_cmd }} {{ azure_pipelines_agent_ctl_auth_flags }} --pool {{ azure_pipelines_agent_ctl_agent_pool }} --agent {{ azure_pipelines_agent_ctl_agent_name }} --work {{ azure_pipelines_agent_ctl_agent_workdir }} --acceptTeeEula'
azure_pipelines_agent_ctl_remove_agent_cmd: '{{ azure_pipelines_agent_ctl_base_config_cmd }} remove {{ azure_pipelines_agent_ctl_auth_flags }}' 